# é¡¹ç›®æ¶æ„æ·±åº¦åˆ†æ

## ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¶æ„

### æŠ€æœ¯æ ˆæ¦‚è§ˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Reactå‰ç«¯     â”‚    â”‚   LangGraph     â”‚    â”‚   å¤–éƒ¨æœåŠ¡      â”‚
â”‚                 â”‚    â”‚      åç«¯       â”‚    â”‚                 â”‚
â”‚ â€¢ Vite         â”‚â—„â”€â”€â–ºâ”‚ â€¢ FastAPI      â”‚â—„â”€â”€â–ºâ”‚ â€¢ Google Search â”‚
â”‚ â€¢ TypeScript   â”‚    â”‚ â€¢ LangGraph    â”‚    â”‚ â€¢ Gemini API    â”‚
â”‚ â€¢ Tailwind CSS â”‚    â”‚ â€¢ Redis        â”‚    â”‚ â€¢ PostgreSQL    â”‚
â”‚ â€¢ Shadcn UI    â”‚    â”‚ â€¢ AsyncIO      â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Agent å·¥ä½œæµç¨‹è¯¦è§£

### çŠ¶æ€å›¾ç»“æ„
```mermaid
graph TD
    A[ç”¨æˆ·è¾“å…¥] --> B[ç”Ÿæˆæœç´¢æŸ¥è¯¢]
    B --> C[æ‰§è¡Œæœç´¢]
    C --> D[åˆ†ææœç´¢ç»“æœ]
    D --> E{ä¿¡æ¯æ˜¯å¦å……è¶³?}
    E -->|å¦| F[è¯†åˆ«çŸ¥è¯†ç©ºç™½]
    F --> G[ç”Ÿæˆè¡¥å……æŸ¥è¯¢]
    G --> C
    E -->|æ˜¯| H[åˆæˆæœ€ç»ˆç­”æ¡ˆ]
    H --> I[è¿”å›ç»“æœä¸å¼•ç”¨]
```

### æ ¸å¿ƒèŠ‚ç‚¹åŠŸèƒ½

#### 1. Query Generation Node (æŸ¥è¯¢ç”ŸæˆèŠ‚ç‚¹)
- **æ–‡ä»¶**: `backend/src/agent/graph.py` - `generate_queries`
- **åŠŸèƒ½**: åŸºäºç”¨æˆ·è¾“å…¥ç”Ÿæˆå¤šä¸ªæœç´¢æŸ¥è¯¢
- **æ¨¡å‹**: Gemini-1.5-flash
- **è¾“å…¥**: ç”¨æˆ·é—®é¢˜
- **è¾“å‡º**: æœç´¢æŸ¥è¯¢åˆ—è¡¨

#### 2. Search Node (æœç´¢èŠ‚ç‚¹) 
- **æ–‡ä»¶**: `backend/src/agent/graph.py` - `search_web`
- **åŠŸèƒ½**: æ‰§è¡Œç½‘ç»œæœç´¢å¹¶æ”¶é›†ç»“æœ
- **å·¥å…·**: Google Search API
- **è¾“å…¥**: æœç´¢æŸ¥è¯¢åˆ—è¡¨
- **è¾“å‡º**: æœç´¢ç»“æœé›†åˆ

#### 3. Reflection Node (åæ€èŠ‚ç‚¹)
- **æ–‡ä»¶**: `backend/src/agent/graph.py` - `reflect_on_search`
- **åŠŸèƒ½**: åˆ†ææœç´¢ç»“æœï¼Œåˆ¤æ–­ä¿¡æ¯å……è¶³æ€§
- **æ¨¡å‹**: Gemini-1.5-flash
- **è¾“å…¥**: é—®é¢˜ + æœç´¢ç»“æœ
- **è¾“å‡º**: åæ€ç»“è®º + åç»­æŸ¥è¯¢å»ºè®®

#### 4. Answer Generation Node (ç­”æ¡ˆç”ŸæˆèŠ‚ç‚¹)
- **æ–‡ä»¶**: `backend/src/agent/graph.py` - `generate_answer`
- **åŠŸèƒ½**: åŸºäºæ”¶é›†çš„ä¿¡æ¯åˆæˆæœ€ç»ˆç­”æ¡ˆ
- **æ¨¡å‹**: Gemini-1.5-flash
- **è¾“å…¥**: é—®é¢˜ + æ‰€æœ‰æœç´¢ç»“æœ
- **è¾“å‡º**: ç»“æ„åŒ–ç­”æ¡ˆ + å¼•ç”¨æ¥æº

## ğŸ“ æ–‡ä»¶ç»“æ„è¯¦è§£

### åç«¯æ¶æ„
```
backend/
â”œâ”€â”€ src/agent/
â”‚   â”œâ”€â”€ __init__.py          # æ¨¡å—åˆå§‹åŒ–
â”‚   â”œâ”€â”€ app.py              # LangGraph åº”ç”¨å®šä¹‰
â”‚   â”œâ”€â”€ configuration.py    # é…ç½®ç®¡ç†å’ŒéªŒè¯
â”‚   â”œâ”€â”€ graph.py            # æ ¸å¿ƒçŠ¶æ€å›¾é€»è¾‘ â­
â”‚   â”œâ”€â”€ prompts.py          # æç¤ºè¯æ¨¡æ¿ â­
â”‚   â”œâ”€â”€ state.py            # çŠ¶æ€æ•°æ®ç»“æ„ â­
â”‚   â”œâ”€â”€ tools_and_schemas.py # å·¥å…·å®šä¹‰å’Œæ•°æ®æ¨¡å¼
â”‚   â””â”€â”€ utils.py            # å·¥å…·å‡½æ•°
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ langgraph.json          # LangGraph é…ç½®
â”œâ”€â”€ pyproject.toml          # Python ä¾èµ–å’Œé…ç½®
â”œâ”€â”€ Makefile                # æ„å»ºå’Œè¿è¡Œè„šæœ¬
â””â”€â”€ test-agent.ipynb        # Jupyter æµ‹è¯•ç¬”è®°æœ¬
```

### å‰ç«¯æ¶æ„
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/         # React ç»„ä»¶
â”‚   â”œâ”€â”€ App.tsx            # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ main.tsx           # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ index.css          # å…¨å±€æ ·å¼
â”œâ”€â”€ public/                # é™æ€èµ„æº
â”œâ”€â”€ package.json           # Node.js ä¾èµ–
â”œâ”€â”€ vite.config.ts         # Vite é…ç½®
â”œâ”€â”€ tailwind.config.js     # Tailwind CSS é…ç½®
â””â”€â”€ components.json        # Shadcn UI é…ç½®
```

## ğŸ”§ å…³é”®ä»£ç åˆ†æ

### 1. çŠ¶æ€å®šä¹‰ (state.py)
```python
from typing import Annotated, List
from typing_extensions import TypedDict
from langgraph.graph.message import add_messages

class State(TypedDict):
    # æ¶ˆæ¯å†å² - ä½¿ç”¨ add_messages å‡½æ•°è¿›è¡Œç´¯ç§¯
    messages: Annotated[List[BaseMessage], add_messages]
    # æœç´¢æŸ¥è¯¢åˆ—è¡¨
    search_queries: List[str]
    # æœç´¢ç»“æœ
    search_results: List[dict]
    # åæ€è½®æ•°
    reflection_count: int
    # æœ€ç»ˆç­”æ¡ˆ
    final_answer: str
```

### 2. æç¤ºè¯è®¾è®¡ (prompts.py)
- **æŸ¥è¯¢ç”Ÿæˆæç¤ºè¯**: æŒ‡å¯¼æ¨¡å‹ä»ç”¨æˆ·é—®é¢˜ä¸­æå–å…³é”®æœç´¢è¯æ¡
- **åæ€æç¤ºè¯**: è¯„ä¼°æœç´¢ç»“æœè´¨é‡ï¼Œè¯†åˆ«ä¿¡æ¯ç©ºç™½
- **ç­”æ¡ˆç”Ÿæˆæç¤ºè¯**: æ•´åˆä¿¡æ¯ï¼Œç”Ÿæˆç»“æ„åŒ–å›ç­”

### 3. å›¾ç»“æ„å®šä¹‰ (graph.py)
```python
# åˆ›å»ºçŠ¶æ€å›¾
graph = StateGraph(State)

# æ·»åŠ èŠ‚ç‚¹
graph.add_node("generate_queries", generate_queries)
graph.add_node("search_web", search_web)
graph.add_node("reflect_on_search", reflect_on_search)
graph.add_node("generate_answer", generate_answer)

# å®šä¹‰è¾¹å’Œæ¡ä»¶è·¯ç”±
graph.add_edge(START, "generate_queries")
graph.add_edge("generate_queries", "search_web")
graph.add_edge("search_web", "reflect_on_search")
graph.add_conditional_edges(
    "reflect_on_search",
    should_continue_research,  # æ¡ä»¶å‡½æ•°
    {
        "continue": "search_web",  # ç»§ç»­æœç´¢
        "finish": "generate_answer"  # ç”Ÿæˆç­”æ¡ˆ
    }
)
```

## ğŸ¯ æ ¸å¿ƒè®¾è®¡æ¨¡å¼

### 1. çŠ¶æ€é©±åŠ¨çš„å·¥ä½œæµ
- æ‰€æœ‰èŠ‚ç‚¹å…±äº«çŠ¶æ€å¯¹è±¡
- çŠ¶æ€åœ¨èŠ‚ç‚¹é—´ä¼ é€’å’Œæ›´æ–°
- æ”¯æŒçŠ¶æ€æ£€æŸ¥ç‚¹å’Œæ¢å¤

### 2. æ¡ä»¶è·¯ç”±
- åŸºäºæœç´¢ç»“æœè´¨é‡å†³å®šä¸‹ä¸€æ­¥
- æœ€å¤§è¿­ä»£æ¬¡æ•°é™åˆ¶é˜²æ­¢æ— é™å¾ªç¯
- çµæ´»çš„å†³ç­–é€»è¾‘

### 3. å·¥å…·é›†æˆ
- æ¨¡å—åŒ–çš„å·¥å…·å®šä¹‰
- æ ‡å‡†åŒ–çš„è¾“å…¥è¾“å‡ºæ ¼å¼
- æ˜“äºæ‰©å±•æ–°çš„å·¥å…·

### 4. æµå¼å“åº”
- å®æ—¶çŠ¶æ€æ›´æ–°
- å‰ç«¯æ¸è¿›å¼æ˜¾ç¤º
- è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ

## ğŸš€ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹

### 1. å¹¶å‘æœç´¢
- å¤šä¸ªæœç´¢æŸ¥è¯¢å¹¶è¡Œæ‰§è¡Œ
- å¼‚æ­¥I/Oå¤„ç†
- è¿æ¥æ± ç®¡ç†

### 2. ç¼“å­˜ç­–ç•¥
- æœç´¢ç»“æœç¼“å­˜
- æ¨¡å‹å“åº”ç¼“å­˜
- Redis ä½œä¸ºç¼“å­˜å±‚

### 3. èµ„æºç®¡ç†
- è¿æ¥æ± å¤ç”¨
- å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- ä¼˜é›…çš„é”™è¯¯å¤„ç†

## ğŸ” è°ƒè¯•å’Œç›‘æ§

### 1. LangSmith é›†æˆ
- æ‰§è¡Œè½¨è¿¹è¿½è¸ª
- æ€§èƒ½æŒ‡æ ‡ç›‘æ§
- è°ƒè¯•ä¿¡æ¯è®°å½•

### 2. æ—¥å¿—ç³»ç»Ÿ
- ç»“æ„åŒ–æ—¥å¿—è®°å½•
- ä¸åŒçº§åˆ«çš„æ—¥å¿—
- ä¾¿äºé—®é¢˜æ’æŸ¥

### 3. å¥åº·æ£€æŸ¥
- API ç«¯ç‚¹çŠ¶æ€ç›‘æ§
- ä¾èµ–æœåŠ¡æ£€æŸ¥
- è‡ªåŠ¨æ¢å¤æœºåˆ¶

---

## ğŸ“š å»¶ä¼¸é˜…è¯»

1. [LangGraph æ¦‚å¿µè¯¦è§£](https://langchain-ai.github.io/langgraph/concepts/)
2. [Agent æ¶æ„æœ€ä½³å®è·µ](https://langchain-ai.github.io/langgraph/how-tos/)
3. [Google Gemini API æ–‡æ¡£](https://ai.google.dev/docs)
4. [React çŠ¶æ€ç®¡ç†æŒ‡å—](https://react.dev/learn/managing-state)
